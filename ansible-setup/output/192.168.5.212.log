
###############################################
PROG_BASE_NAME:           ansible-setup.sh
PROG_USER:                brians
USER:                     root
hostname -f:              wildfly2
HOST_IP:                  192.168.5.212
ANSIBLE_UN:               ansible
PROG_USER_SELECTION:      3
SLAVE_FILE:               0
SHOW_EXPECT_SCRIPT_MSG:   
LOG_FILES_PATH:           
SLAVE_FILE:               0
###############################################


yum update -y

Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.cisp.com
 * extras: mirror.cisp.com
 * updates: mirror.cisp.com
No packages marked for update

yum install -y  java

Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.cisp.com
 * extras: mirror.cisp.com
 * updates: mirror.cisp.com
Package 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64 already installed and latest version
Nothing to do

yum install -y  ant

Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.cisp.com
 * extras: mirror.cisp.com
 * updates: mirror.cisp.com
Package ant-1.9.2-9.el7.noarch already installed and latest version
Nothing to do

yum install -y  python

Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.cisp.com
 * extras: mirror.cisp.com
 * updates: mirror.cisp.com
Package python-2.7.5-69.el7_5.x86_64 already installed and latest version
Nothing to do

useradd --shell /bin/bash --home /home/ansible --comment 'User to run Ansible Playbooks' ansible

ansible:ansible | chpasswd

ansible ALL=(ALL:ALL) NOPASSWD: ALL > /etc/sudoers.d/ansible

chmod 0440 /etc/sudoers.d/ansible

mkdir -p /home/ansible/.ssh

chmod 700 /home/ansible/.ssh

ssh-keygen -v -b 2048 -t rsa -f /home/ansible/.ssh/id_rsa -N ''
Generating public/private rsa key pair.
Your identification has been saved in /home/ansible/.ssh/id_rsa.
Your public key has been saved in /home/ansible/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:Y/th6pe+wcrsI3w+g8EWeQoGblUdG7x7jwRPamuIgCk root@wildfly2
The key's randomart image is:
+---[RSA 2048]----+
|     ..oo.       |
|  . .   oo       |
| . o   ...       |
|  o o o + .      |
| + . o +S*       |
|E .   =.+++      |
|.  . + =.+=+     |
|    . =oB=+o.    |
|       BO*+.     |
+----[SHA256]-----+

sed -i s/root/ansible/g /home/ansible/.ssh/id_rsa.pub

chmod 600 /home/ansible/.ssh/id_rsa

cp /home/ansible/.ssh/id_rsa.pub /home/ansible/.ssh/authorized_keys

chmod 640 /home/ansible/.ssh/authorized_keys

ssh-keyscan 192.168.5.212 >> /home/ansible/.ssh/known_hosts
ssh-keyscan wildfly2 >> /home/ansible/.ssh/known_hosts

chown -R ansible:ansible /home/ansible/.ssh

cat /home/brians/id_rsa.pub >> /home/ansible/.ssh/authorized_keys

rm -f /home/brians/id_rsa.pub

rm -f /home/brians/ansible-setup.sh
